# 게시판 시스템 분석 보고서

## 📋 현재 게시판 구조

### 1. 데이터베이스 구조
```sql
-- 기본 게시글 테이블: competition_posts
- id: UUID (Primary Key)
- competition_id: UUID (외래키 - competitions 테이블)
- title: VARCHAR(200) (게시글 제목)
- content: TEXT (게시글 내용)
- author: VARCHAR(100) (작성자명)
- password: VARCHAR(255) (접근/수정/삭제용 비밀번호)
- created_at: TIMESTAMP (작성일)
- updated_at: TIMESTAMP (수정일)

-- 답글 시스템 (최근 추가)
- parent_id: UUID (부모 게시글 ID, NULL이면 원글)
- is_admin_reply: BOOLEAN (관리자 답글 여부)
- reply_depth: INTEGER (답글 깊이, 0=원글, 1=답글)
- reply_order: INTEGER (같은 부모글 내 답글 순서)
```

### 2. 게시판 접근 플로우

#### 📱 일반 사용자
1. **게시글 목록 보기**: `/competitions/[id]` → "게시판" 탭
   - 원글만 표시 (답글은 숨김)
   - 제목, 작성자, 작성일 표시
   - 검색 기능 (제목, 작성자)
   - 페이지네이션 (10개씩)

2. **게시글 읽기**:
   - 게시글 클릭 → **비밀번호 입력 모달** → 인증 성공 → 상세보기
   - 답글이 있으면 하단에 표시

3. **게시글 작성**:
   - "글쓰기" 버튼 → 작성 모달
   - 필드: 작성자, 제목, 비밀번호, 비밀번호 확인, 내용
   - 비밀번호 일치 검증

4. **게시글 수정/삭제**:
   - 상세보기에서 "수정"/"삭제" 버튼
   - ⚠️ **비밀번호 확인 없음** (최근 변경됨)
   - 삭제 시 확인 다이얼로그만 표시

#### 👑 관리자 (/admin/ 경로)
1. **게시글 목록 보기**:
   - 관리자 대시보드에서 모든 대회 게시글 통합 조회
   - 게시글 제목, 대회명, 작성자, 작성일 표시

2. **게시글 읽기**:
   - **비밀번호 입력 없이** 바로 접근 가능

3. **게시글 수정/삭제**:
   - **비밀번호 확인 없이** 바로 수정/삭제 가능

4. **답글 작성**:
   - 원글에서만 "답글" 버튼 표시
   - 관리자 전용 답글 작성 모달
   - 답글은 파란색 배경으로 구분 표시

### 3. 주요 컴포넌트

#### 📄 PostWriteModal.tsx
- 게시글 작성 모달
- 비밀번호 + 비밀번호 확인 필드
- MessageModal로 에러/성공 메시지 표시

#### 📖 PostDetailModal.tsx  
- 게시글 상세보기/수정 모달
- 답글 목록 표시
- 관리자 답글 작성 버튼 (관리자만)
- 수정/삭제 기능

#### 💬 AdminReplyModal.tsx
- 관리자 전용 답글 작성 모달
- 원글 내용 미리보기
- 자동으로 "Re: [제목]" 형식

#### 🔔 MessageModal.tsx (최근 추가)
- 모든 alert() 대체용 통합 모달
- 성공/오류/경고/정보 타입별 아이콘
- 확인/취소 버튼 지원

### 4. 게시판 정렬 및 필터링

#### 정렬 순서
- **원글**: 작성일 오름차순 (오래된 글이 위, 최근 글이 아래)
- **답글**: 작성일 오름차순 (각 원글 내에서)

#### 필터링
- 원글만 목록에 표시 (`parent_id IS NULL`)
- 답글은 상세보기에서만 확인 가능
- 검색: 제목 또는 작성자명 기준

### 5. 보안 및 권한

#### 접근 권한
- **일반 사용자**: 비밀번호로 게시글 접근
- **관리자**: 모든 게시글 무제한 접근 (`window.location.pathname.includes('/admin/')`)

#### 수정/삭제 권한  
- **모든 사용자**: 비밀번호 확인 없이 수정/삭제 가능 ⚠️
- 삭제 시 확인 메시지만 표시

### 6. 사용자 경험 개선사항

#### ✅ 완료된 개선사항
1. **Header에서 관리자 버튼 제거**: 일반 페이지는 협회소개, 대회안내만
2. **정렬 순서 변경**: 최근 글이 아래로 (시간순)
3. **관리자 게시글 통합 조회**: 관리자 페이지에서 모든 대회 게시글 한눈에
4. **답글 시스템**: 관리자가 게시글에 답변 가능
5. **MessageModal 도입**: alert() → 모달 방식으로 개선

#### ⚠️ 주의사항
1. **비밀번호 보안**: 현재 수정/삭제 시 비밀번호 확인 안 함
2. **관리자 인증**: URL 기반 간단 체크 (`/admin/` 포함 여부)
3. **실시간 업데이트**: 게시글 작성/수정/삭제 후 목록 새로고침

## 🔄 게시판 플로우 요약

```
게시판 탭 클릭
    ↓
원글 목록 표시 (페이지네이션)
    ↓
게시글 클릭
    ↓
[일반 사용자] 비밀번호 입력 → [관리자] 바로 접근
    ↓
게시글 상세보기 + 답글 목록
    ↓
[수정] 바로 편집 모드 | [삭제] 확인 후 삭제 | [답글] 관리자만
```

## 📊 통계
- **총 컴포넌트**: 4개 (PostWrite, PostDetail, AdminReply, Message)
- **데이터베이스 테이블**: 1개 (competition_posts)
- **권한 레벨**: 2개 (일반 사용자, 관리자)
- **게시글 타입**: 2개 (원글, 답글)